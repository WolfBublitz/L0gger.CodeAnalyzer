name: .NET Core

on:
  push:
    branches: "*"
    tags: "*"
  pull_request:
    branches: "*"
  release:
    types:
      - created

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
        - uses: actions/checkout@v3
        - name: Setup .NET Core SDKs
          uses: actions/setup-dotnet@v3
          with:
            dotnet-version:  |
              6.0.x
              7.0.x
              8.0.x
            source-url: https://nuget.pkg.github.com/WolfBublitz/index.json
          env:
            NUGET_AUTH_TOKEN: ${{secrets.GITHUB_TOKEN}}
        - name: Install dependencies
          working-directory: ./src
          run: dotnet restore
        - name: Create NuGet Package
          run: dotnet pack --configuration Release
        - name: Publish NuGet Package to Github
          run: dotnet nuget push src/bin/Release/*.nupkg
          if: startsWith(github.ref, 'refs/tags/')

